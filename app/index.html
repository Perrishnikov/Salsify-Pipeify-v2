<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" href="styles.css" />
        <link
            rel="stylesheet"
            href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20,400,0,0"
        />
        <title>Upload Excel Sheet</title>
        <link rel="shortcut icon" type="image/x-icon" href="favicon.ico" />
    </head>
    <body>
        <div><h1>Pipeify v2</h1></div>
        <div id="dropArea" class="margin-below">
            Drag and drop a Salsify export (Excel) file here, or click to select
        </div>
        <div id="toast-container"></div>

        <div>
            <div id="radioButtons" class="margin-below">
                <div class="subtitle">Ingredient Parsing Options:</div>

                <!-- <div class="option-div">
                    <input
                        type="radio"
                        id="meh"
                        name="parsingOptions"
                        value="meh"
                        class="radio-button"
                    />
                    <label for="meh" class="radio-checkbox-label">Meh</label>
                    <span class="option-context"
                        >- [3t,1p] (As is) Creates 3 columns for each of the ingredient
                        types and 1 row per partcode.</span
                    >
                </div> -->

                <!-- <div class="option-div">
                    <input
                        type="radio"
                        id="option1"
                        name="parsingOptions"
                        value="option1"
                        class="radio-button"
                    />
                    <label for="option1" class="radio-checkbox-label"
                        >1st</label
                    >
                    <span class="option-context"
                        >- [1t,xp] (As is) Creates 1 column for all ingredients and up
                        to 3 rows per partcode.</span
                    >
                </div> -->

                <!-- <div class="option-div">
                    <input
                        type="radio"
                        id="option2"
                        name="parsingOptions"
                        value="option2"
                        class="radio-button"
                    />
                    <label for="option2" class="radio-checkbox-label"
                        >2nd</label
                    >
                    <span class="option-context"
                        >- [1t,xp] (No Validation) Creates 1 column for all ingredients and x
                        rows per ingredient per partcode.</span
                    >
                </div> -->
                <!-- <div class="option-div">
                    <input
                        type="radio"
                        id="option3"
                        name="parsingOptions"
                        value="option3"
                        class="radio-button"
                    />
                    <label for="option3" class="radio-checkbox-label"
                        >3rd</label
                    >
                    <span class="option-context"
                        >- [8,x] (No Validation) Creates 8 columns, 1 for each pipe and x rows per ~ per partcode.</span
                    >
                </div> -->
                <div class="option-div">
                    <input
                        type="radio"
                        id="option4"
                        name="parsingOptions"
                        value="option4"
                        class="radio-button"
                        checked
                    />
                    <label for="option4" class="radio-checkbox-label"
                        >4th</label
                    >
                    <span class="option-context"
                        >- (Cell Validation) Creates 8 ingredient related
                        columns (1 for each pipe AND 1-3 rows per
                        partcode)</span
                    >
                </div>
                <!-- <div class="option-div">
                    <input
                        type="radio"
                        id="option5"
                        name="parsingOptions"
                        value="option5"
                        class="radio-button"
                    />
                    <label for="option5" class="radio-checkbox-label"
                        >5th
                    </label>
                    <span class="option-context"
                        >- Error Correction for import back into Salsify</span
                    >
                </div> -->
            </div>
        </div>

        <!-- <div id="headerCheckboxes" class="margin-below">
                <div class="subtitle">Headers (To Download):</div>
            </div> -->

        <div class="margin-below">
            <button disabled id="download-wysiwyg-btn" class="drag-drop-btn">
                Download For Customer
            </button>

            <button
                disabled
                id="download-for-salsify-btn"
                class="drag-drop-btn"
            >
                Download For Salsify
            </button>
            <button id="clear-localstorage-btn" class="drag-drop-btn">
                Clear Local Storage
            </button>
            <button id="helpBtn" class="drag-drop-btn">Help</button>
        </div>

        <div class="margin-below">
            <div id="fileName" class="subtitle"></div>
            <!-- append imported fileName here -->
        </div>

        <div id="table-container"></div>

        <!-- The Help Modal -->
        <div id="helpModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Pipeify Help Section</h2>
                <p>
                    Pipeify takes a Salsify export, parses it, and exports it. Used for cleaning up ingredients (re-import) and to provide customers with ingredient data.
                </p>
                <ul>
                    <li>
                        Export must have [PARTCODE or Product ID, Nutrients,
                        Ingredients, Other]. Export automatically contains
                        Product ID, which is required for re-import.
                    </li>
                    <li>
                        Removes parent record, parses by option, and leaves
                        other columns as-is.
                    </li>
                    <li>Checks for errors on Order, Description, Qty, UOM, DV, Sym., and Foot. columns.</li>
                </ul>
            </div>
        </div>

        <script src="scripts/toast.js"></script>
        <script src="scripts/globals.js"></script>
        <script src="scripts/cell-validations.js"></script>
        <script src="scripts/processes/process_0.js"></script>
        <script src="scripts/processes/process_1.js"></script>
        <script src="scripts/processes/process_2.js"></script>
        <script src="scripts/processes/process_3.js"></script>
        <script src="scripts/processes/process_4b.js"></script>
        <script src="scripts/main.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
        <script src="scripts/import-export.js"></script>
        <script src="scripts/dom.js"></script>
        <script></script>
    </body>
</html>
